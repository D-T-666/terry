var s={current:void 0,total:void 0,container:void 0,elementsOfPage:void 0,pageRadio:void 0,init({total:t,container:e}){this.total=t,this.container=e,this.elementsOfPage=[],this.pageRadio=[];for(let a=0;a<this.total;a++){let n=document.createElement("input");n.type="radio",n.name="current-page",n.addEventListener("change",p=>{p.target.checked&&(this.hidePage(),this.showPage(a))}),this.pageRadio.push(n);let r=document.createElement("label");r.innerText=a+1,r.appendChild(n),this.container.appendChild(r),this.elementsOfPage.push([])}},hidePage(){for(let t of this.elementsOfPage[this.current])t.classList.remove("current")},showPage(t){this.current=t,this.pageRadio[t].checked=!0;for(let e of this.elementsOfPage[this.current])e.classList.add("current","visited")},registerElement(t){switch(t.dataset.visibilityType||"always"){case"only":let a=Number(t.dataset.visibleOnlyOn);this.trackElementOnly(t,a);break;case"range":let n=Number(t.dataset.visibleFrom),r=Number(t.dataset.visibleTo);this.trackElementRange(t,n,r);break}for(let a of t.children)this.registerElement(a);console.log(this.elementsOfPage)},untrackElement(t){for(let e of this.elementsOfPage){let a=e.indexOf(t);a>=0&&e.splice(a,1)}},trackElementOnly(t,e,a=!0){this.untrackElement(t),this.elementsOfPage[e-1].push(t)},trackElementRange(t,e,a){this.untrackElement(t);for(let n=e;n<=a;n++)this.elementsOfPage[n-1].push(t)}};var o=class extends HTMLElement{constructor(){super()}connectedCallback(){this.tabs=document.createElement("div"),this.tabs.classList.add("tabs"),this.urlBar=document.createElement("div"),this.urlBar.classList.add("url");let e=document.createElement("div");e.classList.add("header"),e.append(this.tabs,this.urlBar),this.pages=document.createElement("div"),this.pages.classList.add("pages"),this.pages.innerHTML=this.innerHTML,this.innerHTML="",this.append(e,this.pages),this.pagesByURL={};for(let n of this.pages.children)this.pagesByURL[n.getAttribute("url")]=n;console.log(this.pagesByURL),this.visibleTabs={},this.currentPageUrl=void 0;let a=!0;for(let n of this.pages.children)n.getAttribute("visible")!==null&&(this.createTab(n.getAttribute("url")),a&&(this.showPage(n.getAttribute("url")),a=!1))}showPage(e){this.currentPageUrl!==void 0&&(this.pagesByURL[this.currentPageUrl].classList.remove("current"),this.visibleTabs[this.currentPageUrl]&&this.visibleTabs[this.currentPageUrl].classList.remove("current")),this.pagesByURL[e].classList.add("current"),this.visibleTabs[e]===void 0&&this.createTab(e),this.visibleTabs[e].classList.add("current"),this.urlBar.innerText=`https://${e}`,this.currentPageUrl=e}createTab(e){let a=document.createElement("span");a.classList.add("tab");let n=document.createElement("button");if(n.innerText=this.pagesByURL[e].getAttribute("title"),n.addEventListener("click",r=>this.showPage(e)),a.appendChild(n),this.pagesByURL[e].getAttribute("nonclosable")===null){let r=document.createElement("button");r.innerHTML="&#10005;",r.addEventListener("click",p=>{if(this.visibleTabs[e].remove(),delete this.visibleTabs[e],this.currentPageUrl===e&&(this.pagesByURL[e].classList.remove("current"),this.currentPageUrl=void 0,this.urlBar.innerText="",Object.keys(this.visibleTabs).length>0)){let f=Object.keys(this.visibleTabs)[0];this.showPage(f)}}),a.appendChild(r)}this.tabs.appendChild(a),this.visibleTabs[e]=a}},d=class extends HTMLElement{constructor(){super(),this.addEventListener("click",this.click)}connectedCallback(){let e=this.getAttribute("browser");if(e!==null)this.targetBrowser=document.getElementById(e);else{let a=this;for(;a.parentElement;)if(a=a.parentElement,a.tagName==="BROWSER-SIM"){this.targetBrowser=a;break}}}click(e){this.targetBrowser.showPage(this.getAttribute("to")),this.targetBrowser.scrollIntoView({block:"nearest",behavior:"smooth"})}},l=class extends HTMLElement{constructor(){super()}};customElements.define("browser-sim",o);customElements.define("browser-link",d);customElements.define("browser-page",l);var y={Authorization:"Bearer "+(localStorage.getItem("authToken")??"")};function g(){return y}var h="https://terryapi.dimitri.ge/api";async function u(t){let e=await fetch(`${h}/test/${t}`,{headers:g()});if(!e.ok)throw new Error(e.statusText);let a=await e.json();return{id:t,...a}}var i;async function m(t){if(t!==void 0)try{return i=await u(t),i}catch(a){console.log(a)}let e=localStorage.getItem("currentFile");return e!=null?i=JSON.parse(e):i={content:'<div data-type="container" data-name="\u10DB\u10D7\u10D0\u10D5\u10D0\u10E0\u10D8 \u10D9\u10DD\u10DC\u10E2\u10D4\u10D8\u10DC\u10D4\u10E0\u10D8" id="0" data-pages="1"></div>'},i}var c=document.getElementById("main-content"),w=document.getElementById("page-controls"),x=document.getElementById("test-name"),T=window.location.search,k=new URLSearchParams(T),b=k.get("id");if(b!==void 0){let{name:t,content:e}=await m(b);c.innerHTML=e,x.textContent=t,s.init({total:c.firstChild.dataset.pages,container:w}),s.registerElement(c.firstElementChild),s.showPage(0)}
