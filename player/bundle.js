var n={current:void 0,total:void 0,container:void 0,elementsOfPage:void 0,pageRadio:void 0,init({total:a,container:e}){this.total=a,this.container=e,this.elementsOfPage=[],this.pageRadio=[];for(let t=0;t<this.total;t++){let r=document.createElement("input");r.type="radio",r.name="current-page",r.addEventListener("change",c=>{c.target.checked&&(this.hidePage(),this.showPage(t))}),this.pageRadio.push(r);let i=document.createElement("label");i.innerText=t+1,i.appendChild(r),this.container.appendChild(i),this.elementsOfPage.push([])}},hidePage(){for(let a of this.elementsOfPage[this.current])a.classList.remove("current")},showPage(a){this.current=a,this.pageRadio[a].checked=!0;for(let e of this.elementsOfPage[this.current])e.classList.add("current","visited")},registerElement(a){switch(a.dataset.visibilityType||"always"){case"only":let t=Number(a.dataset.visibleOnlyOn);this.trackElementOnly(a,t);break;case"range":let r=Number(a.dataset.visibleFrom),i=Number(a.dataset.visibleTo);this.trackElementRange(a,r,i);break}for(let t of a.children)this.registerElement(t);console.log(this.elementsOfPage)},untrackElement(a){for(let e of this.elementsOfPage){let t=e.indexOf(a);t>=0&&e.splice(t,1)}},trackElementOnly(a,e,t=!0){this.untrackElement(a),this.elementsOfPage[e-1].push(a)},trackElementRange(a,e,t){this.untrackElement(a);for(let r=e;r<=t;r++)this.elementsOfPage[r-1].push(a)}};var m={Authorization:"Bearer "+(localStorage.getItem("authToken")??"")};function h(){return m}var g="https://eko.dimitri.ge/api";async function p(a){let e=await fetch(`${g}/test/${a}`,{headers:h()});if(!e.ok)throw new Error(e.statusText);return await e.json()}var s=class extends HTMLElement{constructor(){super()}connectedCallback(){this.tabs=document.createElement("div"),this.tabs.classList.add("tabs"),this.urlBar=document.createElement("div"),this.urlBar.classList.add("url");let e=document.createElement("div");e.classList.add("header"),e.append(this.tabs,this.urlBar),this.pages=document.createElement("div"),this.pages.classList.add("pages"),this.pages.innerHTML=this.innerHTML,this.innerHTML="",this.append(e,this.pages),this.pagesByURL={};for(let r of this.pages.children)this.pagesByURL[r.getAttribute("url")]=r;console.log(this.pagesByURL),this.visibleTabs={},this.currentPageUrl=void 0;let t=!0;for(let r of this.pages.children)r.getAttribute("visible")!==null&&(this.createTab(r.getAttribute("url")),t&&(this.showPage(r.getAttribute("url")),t=!1))}showPage(e){this.currentPageUrl!==void 0&&(this.pagesByURL[this.currentPageUrl].classList.remove("current"),this.visibleTabs[this.currentPageUrl]&&this.visibleTabs[this.currentPageUrl].classList.remove("current")),this.pagesByURL[e].classList.add("current"),this.visibleTabs[e]===void 0&&this.createTab(e),this.visibleTabs[e].classList.add("current"),this.urlBar.innerText=`https://${e}`,this.currentPageUrl=e}createTab(e){let t=document.createElement("span");t.classList.add("tab");let r=document.createElement("button");if(r.innerText=this.pagesByURL[e].getAttribute("title"),r.addEventListener("click",i=>this.showPage(e)),t.appendChild(r),this.pagesByURL[e].getAttribute("nonclosable")===null){let i=document.createElement("button");i.innerHTML="&#10005;",i.addEventListener("click",c=>{if(this.visibleTabs[e].remove(),delete this.visibleTabs[e],this.currentPageUrl===e&&(this.pagesByURL[e].classList.remove("current"),this.currentPageUrl=void 0,this.urlBar.innerText="",Object.keys(this.visibleTabs).length>0)){let b=Object.keys(this.visibleTabs)[0];this.showPage(b)}}),t.appendChild(i)}this.tabs.appendChild(t),this.visibleTabs[e]=t}},o=class extends HTMLElement{constructor(){super(),this.addEventListener("click",this.click)}connectedCallback(){let e=this.getAttribute("browser");if(e!==null)this.targetBrowser=document.getElementById(e);else{let t=this;for(;t.parentElement;)if(t=t.parentElement,t.tagName==="BROWSER-SIM"){this.targetBrowser=t;break}}}click(e){this.targetBrowser.showPage(this.getAttribute("to")),this.targetBrowser.scrollIntoView({block:"nearest",behavior:"smooth"})}},d=class extends HTMLElement{constructor(){super()}};customElements.define("browser-sim",s);customElements.define("browser-link",o);customElements.define("browser-page",d);var l=document.getElementById("main-content"),f=document.getElementById("page-controls"),y=window.location.search,x=new URLSearchParams(y),u=x.get("id");if(u!==void 0){let a=await p(u);l.innerHTML=a.content,n.init({total:l.firstChild.dataset.pages,container:f}),n.registerElement(l.firstElementChild),n.showPage(0)}
